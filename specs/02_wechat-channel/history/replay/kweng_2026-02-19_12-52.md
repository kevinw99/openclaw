# Spec 02: wechat-channel - Session Replay

## Session: 2026-02-19T12:52 ~ 13:18

> Person: kweng | Messages: 64 | Turns: 5

---

### 12:52 - how many channels we have here in the project, can you...

**Prompt:**

> how many channels we have here in the project, can you compare the size of implementation? take whatsapp as example, explain the code base for it

**Result:**
Current working directory: `/Users/kweng/AI/openclaw`

_Tools: Bash (1), Task (2) -- Print working directory_

---

### 13:04 - "WhatsApp is interesting because its code is split across...

**Prompt:**

> "WhatsApp is interesting because its code is split across several locations:
> " why? this is a new implementation. we have all the liberty to make sound decision

**Result:**
You're right to question this. There's a clear **two-tier architecture** in the project, and it's not by design — it's legacy vs. modern.

## The Pattern

**Newer channels (feishu, matrix, msteams, googlechat, nostr, tlon, twitch, etc.)** are **fully self-contained** inside `extensions/<name>/`:

```
extensions/feishu/src/
├── channel.ts       # Plugin definition
├── config-schema.ts # Types + validation
├── monitor.ts       # Inbound messages
├── outbound.ts      # Sending messages
├── onboarding.ts    # Setup wizard
├── targets.ts       # ID normalization
├── types.ts         # Local types
└── ...              # Everything else
```

**Older channels (whatsapp, discord, slack, telegram, signal, imessage)** are **scattered** across 4+ directories:

```
extensions/whatsapp/src/channel.ts          # thin wrapper
src/whatsapp/normalize.ts                   # target parsing
src/web/inbound/monitor.ts                  # inbox listener
src/web/outbound.ts                         # sending
src/web/auto-reply/monitor.ts               # message loop
src/channels/plugins/outbound/whatsapp.ts   # adapter
src/channels/plugins/onboarding/whatsapp.ts # setup wizard
src/channels/plugins/status-issues/whatsapp.ts
src/channels/plugins/agent-tools/whatsapp-login.ts
src/channels/plugins/whatsapp-heartbeat.ts
src/config/types.whatsapp.ts                # config types
src/config/zod-schema.providers-whatsapp.ts # validation
```

## Why This Is a Problem

|                    | Self-contained (feishu) | Split (whatsapp)                                    |
| ------------------ | ----------------------- | --------------------------------------------------- |
| **Files to touch** | 1 directory             | 5+ directories                                      |
| **Ownership**      | Clear                   | Ambiguous                                           |
| **Config types**   | Local `types.ts`        | `src/config/types.whatsapp.ts`                      |
| **Onboarding**     | Local `onboarding.ts`   | `src/channels/plugins/onboarding/`                  |
| **Normalize**      | Local `targets.ts`      | `src/whatsapp/` + `src/channels/plugins/normalize/` |

## Bottom Line

Since you're building **WeChat as a new implementation**, you have the luxury of following the **self-contained pattern** — everything inside `extensions/wechat/src/`. That's the direction the project has clearly evolved toward, and channels like feishu, matrix, and msteams prove it works well.

Don't follow whatsapp's layout. Follow feishu's.

_Tools: Bash (2), Task (1) -- List all extension directories; List all src directories_

---

### 13:15 - sure follow feishu; 2 is feishu a new channel added after...

**Prompt:**

> sure follow feishu; 2 is feishu a new channel added after intial launch of openclaw, or a built in one? 3. if feishu was added, how come wechat is not

**Result:**
Clear picture now.

## Timeline

| Date              | Event                                                                                        |
| ----------------- | -------------------------------------------------------------------------------------------- |
| **2025-11-24**    | Initial commit (legacy channels: WhatsApp, Discord, Slack, Telegram, Signal, iMessage, Line) |
| **2026-01-15**    | Extension wave begins: Matrix, Zalo                                                          |
| **2026-01-16–27** | MS Teams, Bluebubbles, Nextcloud, Nostr, Mattermost, Google Chat, Tlon, Twitch               |
| **2026-02-02**    | Feishu added (most recent extension)                                                         |
| **Now**           | WeChat — not yet in git history                                                              |

## Answers

**2. Feishu is a new channel**, added Feb 2. The project launched Nov 24, 2025 with the legacy channels (WhatsApp, Discord, Slack, etc.) baked into `src/`. Starting mid-January, a wave of ~12 new channels were added using the self-contained `extensions/` pattern.

**3. WeChat simply hasn't been built yet.** The `extensions/wechat/` directory you have is your local work-in-progress — there's no git history for it. Feishu landed because someone contributed it (the commit is marked with a robot emoji, suggesting AI-assisted). WeChat hasn't had a contributor yet — until now.

The good news: you're building it at the right time. The extension architecture is mature (12 channels prove the pattern works), and feishu is the freshest example to follow.

_Tools: Bash (10) -- Find when feishu was first added; Earliest feishu commits; Earliest commits in the project_

---

### 13:17 - ok follow feishu and mkae all changes needed

**Prompt:**

> ok follow feishu and mkae all changes needed

**Result:**
_(no text response — tools only)_

---

### 13:18 - [Request interrupted by user]

**Prompt:**

> [Request interrupted by user]

**Result:**
_(no text response — tools only)_

---
